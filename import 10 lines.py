#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Nov  1 13:25:37 2019

@author: tmh
"""

# -*- coding: utf-8 -*-
"""
Created on Thu Oct 31 16:31:10 2019

@author: Aditya Didwania
"""



import numpy as np
import pymysql
import pandas as pd
from sqlalchemy import create_engine
db = pymysql.connect(host='localhost',
user='root',
password='3p2a1o2333',
db='db_consumer_panel2',
charset='utf8mb4',
cursorclass=pymysql.cursors.DictCursor)
engine = create_engine('mysql+pymysql://root:3p2a1o2333@localhost/db_consumer_panel2')







dta_at_hh = pd.read_csv("/Users/tmh/Desktop/bdm/dta_at_hh.csv")
b1=dta_at_hh.drop('Unnamed: 0', axis=1)
filter=[2070841,8034573,8089790,8127731,8210330,8215790,8236635,8278811,9001556,9156682]
b1_sample=b1[b1['hh_id'].isin(filter)]
pd.io.sql.to_sql(b1_sample,'households', con=engine, index=False, if_exists='append')

dta_at_prod_id = pd.read_csv("/Users/tmh/Desktop/bdm/dta_at_prod_id.csv")
b2=dta_at_prod_id.drop('Unnamed: 0', axis=1)
filter_prod=[100001087957081,100003814221599,100003886102970,100005830621411,100007500102178,100008165210077,100071722680513,100073772952220,100088392936336,100967582824162]
b2_sample=b2[b2['prod_id'].isin(filter_prod)]
pd.io.sql.to_sql(b2_sample,'products', con=engine, index=False, if_exists='append')

dta_at_TC = pd.read_csv("/Users/tmh/Desktop/bdm/dta_at_TC.csv")
b3=dta_at_TC.drop('Unnamed: 0', axis=1)
filter=[2070841,8034573,8089790,8127731,8210330,8215790,8236635,8278811,9001556,9156682]
b3_sample=b3[b3['hh_id'].isin(filter)]
pd.io.sql.to_sql(b3_sample,'trips', con=engine, index=False, if_exists='append')


dta_at_tc_upc = pd.read_csv("/Users/tmh/Desktop/bdm/dta_at_tc_upc.csv")
b4=dta_at_tc_upc.drop('Unnamed: 0', axis=1)
filter_tcid=[13848,19929,31768,32754,41828,41829,41830,51028,51222,51223,52311,52312,62378,72483,73647,80249,80250,88536,100492,100493,104546,105627,115488,120983,126610,126611,140191,140192,140193,140194,142370,142371,151450,151451,151452,151453,157640,157641,165629,165630,166556,166557,174944,182301,182302,182303,183148,183149,187004,199511,203410,214996,215164,215165,216101,221087,233194,233195,233196,233197,242742,242743,250119,254231,280299,280300,286845,286846,286847,294222,294223,307981,311361,311362,312255,320305,320306,328424,331920,340934,342820,346501,354683,356489,360055,361045,370681,382267,388984,392777,403654,403655,407176,419353,421595,422551,438568,439427,441910,441911,447486,454758,463761,463762,466278,471033,472088,480405,483243,489651,489652,489653,493925,499393,503102,515158,515159,550586,550587,555421,555422,564969,564970,573094,573095,573096,580661,584469,588360,595660,599318,608178,610080,610081,614776,614777,633412,636525,636526,637921,637922,645405,661270,665024,665025,674088,678711,678712,683491,684601,695785,704032,711614,711806,711807,711808,711809,711810,723640,723641,723642,729474,744883,755285,755286,758779,761058,762784,762785,773655,777794,777795,788345,793543,793544,797157,802938,811480,819705,824713,828176,829688,834029,834030,853267,853268,858037,859127,859128,864406,864407,864408,872259,873651,875910,879774,889919,919610,919611,919612,929728,932549,937916,951287,954540,954541,954542,954543,955417,960500,963410,986638,987681,1003901,1004849,1004850,1014334,1019994,1019995,1021635,1021636,1025624,1051286,1051287,1074290,1081535,1081536,1082342,1082343,1090258,1098283,1098284,1098285,1106227,1108791,1108792,1113343,1114411,1118388,1119492,1128557,1130815,1130816,1141719,1141720,1145251,1145252,1149334,1152218,1153534,1168373,1176304,1179934,1186842,1195485,1211532,1212464,1212465,1220860,1223465,1228396,1229312,1229313,1237703,1237704,1237705,1237706,1237707,1245327,1246455,1246456,1248950,1257709,1257710,1264050,1269675,1279708,1279709,1285356,1292119,1306401,1307657,1307658,1318024,1325406,1326249,1326250,1326251,1326252,1326253,1334448,1338703,1338704,1342911,1351042,1351043,1351044,1353549,1353550,1359140,1359141,1359142,1361567,1374701,1374889,1390161,1393341,1397549,1406172,1406173,1406174,1408350,1410053,1410054,1417212,1420480,1420481,1424584,1430313,1434652,1435819,1439294,1445906,1448646,1453661,1454657,1454658,1467127,1467128,1470287,1471132,1473638,1479107,1486056,1486057,1502027,1511491,1511492,1511493,1514146,1514147,1519477,1519478,1524795,1535390,1561507,1562735,1562736,1562737,1562738,1569828,1575628,1575629,1581517,1581518,1597463,1597464,1597465,1600852,1603548,1603549,1606488,1613746,1614559,1617012,1617013,1622571,1629518,1630537,1634405,1634406,1647591,1647592,1664085,1664086,1671120,1671121,1689789,1702422,1713526,1713527,1716403,1723980,1723981,1730000,1733131,1757371,1757530,1757531,1757532,1758433,1758434,1786420,1786421,1793864,1797890,1812639,1812640,1814989,1814990,1828556,1828557,1831678,1831679,1834468,1837691,1840883,1840884,1857359,1858268,1860782,1862418,1866773,1866774,1866775,1866776,1869565,1874848,1874849,1878465,1892481,1892669,1899108,1902897,1908477,1912761,1913820,1920569,1928780,1928781,1937593,1937594,1937595,1941429,1941430,1941431,1945189,1948082,1972166,1979885,1984157,1987121,1995799,1998181,2000856,2003691,2003692,2018779,2018954,2024733,2030438,2032237,2055125,2066522,2076483,2077743,2096732,2099189,2101922,2101923,2104890,2104891,2113301,2118575,2124132,2128649,2129444,2144564,2145509,2149549,2153753,2162742,2165513,2165514,2165515,2179368,2183046,2193466,2193467,2199103,2207814,2207815,2207816,2216956,2216957,2221749,2221750,2221751,2227952,2238082,2238904,2238905,2238906,2243940,2247009,2247010,2260105,2262943,2262944,2265544,2269991,2281962,2287179,2287180,2287181,2287182,2288146,2292521,2300856,2300857,2318463,2318464,2329871,2347738,2347925,2348798,2351492,2351493,2351494,2351495,2357444,2361934,2366073,2366074,2374369,2376903,2376904,2376905,2382494,2382495,2397867,2414760,2420213,2434923,2439196,2439197,2439198,2439199,2456693,2468565,2468566,2473970,2489691,2502590,2504459,2515595,2520134,2531971,2531972,2552504,2597889,2597890,2600375,2600376,2600377,2606145,2608639,2608640,2616742,2624802,2630212,2638127,2638128,2645103,2645282,2645283,2648457,2648458,2675554,2675555,2679030,2679031,2698587,2702684,2713870,2713871,2713872,2716396,2716397,2753601,2753602,2754405,2754406,2758520,2769836,2788659,2791477,2791478,2793267,2805038,2807686,2808867,2818890,2818891,2822261,2822262,2822263,2828446,2829605,2829606,2839170,2841747,2847330,2857639,2859354,2862548,2862549,2862550,2875745,2888062,2893666,2893667,2895502,2895503,2896624,2896625,2896626,2896627,2916636,2916637,2918331,2942834,2942835,2942836,2942837,2953001,2954173,2971537,2980492,2987583,2988380,3003775,3006007,3011619,3011620,3011621,3011622,3016978,3018798,3019816,3033542,3054148,3055184,3061233,3081904,3093564,3093565,3094382,3094383,3096688,3104900,3104901,3104902,3104903,3118760,3126921,3126922,3132095,3134963,3142437,3154394,3154395,3160574,3163161,3163162,3169863,3179450,3179451,3196283,3201413,3213814,3218387,3218388,3219215,3224160,3227060,3227061,3235444,3243348,3243349,3243350,3246182,3251513,3253791,3255462,3270169,3282065,3282066,3284241,3284242,3294317,3294318,3294319,3310612,3324365,3324366,3324367,3331065,3338371,3338372,3338373,3344156,3346497,3349355,3355083,3355084,3360100,3360941,3369219,3369220,3372118,3377825,3377826,3380232,3394469,3411523,3413931,3414947,3414948,3417816,3435149,3435150,3435151,3435152,3449601,3467712,3467713,3467714,3467715,3467716,3481138,3481139,3488918,3489823,3500617,3500618,3506151,3506152,3508513,3510202,3514248,3521815,3521979,3522814,3530892,3539117,3539118,3539119,3565123,3580910,3586733,3601959,3601960,3610433,3610434,3613102,3615010,3615800,3626610,3631175,3631176,3639862,3639863,3645822,3647569,3665155,3665156,3666141,3671575,3679247,3686186,3696132,3702997,3707279,3708450,3708451,3718171,3721263,3721264,3729110,3734943,3743557,3751321,3754536,3758997,3758998,3764825,3770898,3775537,3776524,3776525,3793225,3813068,3813069,3814146,3828894,3843451,3849616,3857664,3857665,3857666,3857667,3866806,3872384,3876381,3886252,3888794,3900062,3900063,3904703,3904855,3904856,3910836,3917669,3920782,3920783,3923054,3923055,3945099,3945100,3955453,3955454,3955456,3979001,3979002,3979003,3982613,3988436,3988437,3990790,3992578,4000274,4001983,4001984,4005288,4006151,4014377,4014378,4035563,4035564,4040103,4040265,4040266,4041079,4041080,4045144,4046237,4059437,4064980,4080142,4103509,4106726,4117469,4122265,4123138,4128422,4134833,4136435,4139655,4139656,4148502,4152029,4154791,4159917,4159918,4159919,4161701,4162790,4162791,4165611,4169494,4174124,4175079,4183543,4193315,4210541,4210542,4210543,4212941,4236154,4236155,4247386,4251183,4256688,4256689,4256690,4262049,4264836,4264837,4268568,4274172,4276466,4285977,4290636,4290637,4303254,4307758,4307913,4308727,4316862,4325845,4326731,4340573,4346279,4346280,4347319,4347320,4365558,4365559,4374154,4374155,4376929,4381102,4385028,4392942,4392943,4407151,4407152,4412961,4415804,4424981,4432949,4432950,4441477,4442411,4447471,4450512,4454748,4454749,4454750,4465865,4480302,4480519,4480520,4504388,4516026,4519923,4524767,4525547,4527719,4543414,4555676,4555677,4560602,4560603,4563914,4569852,4569853,4578933,4585332,4593200,4598740,4598741,4599696,4614257,4617632,4617633,4619986,4620999,4627317,4639017,4642744,4662043,4662793,4674578,4679210,4687939,4691705,4696177,4699246,4704843,4708885,4711658,4713447,4713627,4714439,4722389,4726548,4732402,4732403,4732404,4732405,4752051,4752052,4769174,4769175,4795501,4798534,4798535,4807849,4812439,4821149,4829697,4834466,4838233,4838234,4846462,4847325,4847326,4847327,4859282,4867398,4882482,4885890,4896026,4896027,4896028,4904077,4908285,4908286,4909400,4912445,4923309,4926059,4927923,4928696,4933783,4945541,4945542,4953153,4957003,4957004,4959607,4962263,4962264,4964465,4978207,4987205,5006526,5006527,5006528,5013652,5017317,5024583,5024584,5028220,5028221,5040253,5055183,5059663,5060477,5073745,5077447,5077448,5077449,5085254,5093705,5094502,5094503,5094504,5096679,5099529,5099530,5109281,5111064,5120020,5129790,5129791,5130699,5130700,5133289,5152017,5152018,5153107,5176528,5177754,5183764,5183765,5185030,5194742,5196721,5199829,5214391,5214392,5217423,5231551,5231552,5232317,5232318,5232319,5248338,5248513,5249267,5249268,5266595,5266596,5266597,5267492,5267493,5276345,5276346,5285119,5285120,5285121,5285122,5285123,5287535,5287536,5298588,5332238,5337546,5348806,5348807,5365585,5366329,5368474,5383368,5383369,5400857,5404013,5410812,5410813,5422314,5423350,5428712,5430048,5440674,5442893,5447090,5447091,5448233,5448234,5455613,5467013,5467014,5467741,5470004,5470005,5471951,5484497,5485276,5504430,5507399,5510161,5510162,5519822,5519823,5537706,5560864,5607293,5607294,5610240,5613018,5621836,5622620,5630522,5642463,5648286,5652653,5657431,5657432,5658219,5658220,5674323,5676427,5694839,5696410,5699059,5705820,5717810,5732895,5732896,5735790,5745921,5758454,5768954,5802021,5808101,5808102,5813021,5813022,5819283,5836759,5836760,5841903,5859245,5861405,5874378,5887323,5892539,5899861,5904630,5907508,5913257,5917568,5930962,5940656,5940657,5941450,5954693,5960764,5960765,5982699,5982700,6019136,6019137,6023570,6029279,6031552,6031553,6034576,6044706,6044707,6046685,6055460,6055461,6064631,6064632,6065423,6065424,6065425,6067572,6069393,6069394,6073250,6083045,6096363,6128761,6128762,6128763,6131298,6131299,6152758,6160909,6171435,6182191,6185714,6195116,6197586,6198543,6208779,6208780,6208781,6208782,6214683,6214684,6220844,6221054,6221055,6221056,6229129,6295879,6297029,6297030,6297031,6317320,6318091,6322498,6331438,6331439,6331440,6336344,6339421,6339422,6345459,6355480,6361932,6374840,6384668,6390369,6390370,6393661,6393662,6396945,6396946,6396947,6396948,6396949,6396950,6399581,6399582,6399583,6403039,6446966,6446967,6446968,6464299,6469607,6469608,6470464,6470465,6490248,6490249,6510064,6512469,6512470,6512471,6514721,6518902,6528957,6544165,6544166,6549812,6550666,6560660,6560661,6560662,6571368,6571369,6575271,6582482,6601830,6601831,6623095,6623919,6637806,6642958,6646151,6652633,6662794,6663613,6663614,6663615,6663616,6668185,6672635,6682939,6684003,6684004,6684005,6698495,6698496,6705064,6705065,6732693,6732694,6736822,6736823,6755660,6776824,6779887,6779888,6779889,6779890,6779891,6782551,6784811,6789460,6798831,6802263,6812773,6825834,6825835,6832494,6848712,6852840,6852841,6856753,6872295,1000011645,1000025342,1000032415,1000037309,1000037310,1000046012,1000047320,1000052654,1000070909,1000075820,1000088045,1000093761,1000094546,1000102997,1000118249,1000118250,1000122721,1000129427,1000147724,1000157939,1000157940,1000158544,1000171094,1000171095,1000184977,1000185930,1000188174,1000199976,1000201381,1000208325,1000211073,1000211074,1000223523,1000239187,1000240899,1000241838,1000245610,1000263246,1000267934,1000286340,1000294679,1000294680,1000294681,1000296965,1000299255,1000301199,1000303382,1000304709,1000308958,1000312394,1000325852,1000328968,1000332752,1000337541,1000338827,1000338828,1000339654,1000344280,1000347346,1000349592,1000351514,1000369266,1000378329,1000389030,1000391175,1000395455,1000397501,1000398202,1000403140,1000403141,1000407083,1000426889,1000426890,1000435575,1000437595,1000439130,1000446381,1000450034,1000454582,1000457583,1000458149,1000462117,1000465794,1000477427,1000486950,1000489314,1000490012,1000491571,1000494972,1000496904,1000505741,1000505742,1000507875,1000513772,1000515331,1000516376,1000516377,1000517883,1000521195,1000526296,1000530447,1000564018,1000565628,1000565629,1000568750,1000568751,1000570382,1000570684,1000588357,1000590882,1000591665,1000591666,1000605841,1000605842,1000607483,1000623744,1000625427,1000629996,1000631422,1000635605,1000642738,1000644362,1000648490,1000651043,1000663045,1000663848,1000665400,1000667787,1000670510,1000672890,1000678050,1000691764,1000697231,1000711129,1000726716,1000740977,1000750118,1000767208,1000778531,1000779270,1000779271,1000787987,1000787988,1000802956,1000807963,1000815501,1000847443,1000849900,1000857670,1000861644,1000883499,1000895212,1000895213,1000895214,1000901037,1000901846,1000909907,1000909908,1000910275,1000910276,1000910277,1000914274,1000914941,1000916173,1000919788,1000928227,1000930684,1000930685,1000931409,1000933561,1000941688,1000945548,1000945894,1000955146,1000955147,1000955148,1000963767,1000964436,1000990151,1000990152,1000990153,1000990154,1001001152,1001011093,1001018505,1001030258,1001030259,1001034800,1001034801,1001048287,1001057058,1001059914,1001060579,1001080510,1001083949,1001090016,1001095566,1001100210,1001109458,1001114254,1001124119,1001125170,1001127387,1001138237,1001141244,1001142962,1001145879,1001147538,1001150630,1001158612,1001162551,1001170065,1001173002,1001177604,1001182204,1001183883,1001203228,1001207051,1001207052,1001207053,1001207054,1001208533,1001210119,1001210891,1001212910,1001212911,1001217417,1001223643,1001229102,1001236378,1001238650,1001240351,1001241078,1001247657,1001252154,1001252155,1001252156,1001255033,1001256521,1001256522,1001258034,1001269874,1001273001,1001273002,1001274624,1001275281,1001275282,1001275837,1001277313,1001281762,1001281763,1001286327,1001290779,1001292364,1001292365,1001294127,1001307161,1001312096,1001313741,1001313742,1001316495,1001322265,1001325020,1001325021,1001325022,1001325869,1001326748,1001338110,1001343513,1001344778,1001345465,1001346824,1001347039,1001349111,1001351894,1001353258,1001355438,1001358169,1001358170,1001359831,1001368859,1001374149,1001375734,1001391133,1001400134,1001401961,1001406469,1001410634,1001413517,1001414105,1001431851,1001432181,1001456294,1001456295,1001477869,1001490780,1001491023,1001495691,1001507314,1001514429,1001522346,1001525363,1001530149,1001546640,1001547341,1001550987,1001555381,1001555382,1001555383,1001559622,1001559623,1001559624,1001568136,1001572455,1001578649,1001582883,1001582884,1001602309,1001604155,1001608196,1001608197,1001608198,1001620931,1001622375,1001623062,1001637685,1001651537,1001653324,1001654063,1001657985,1001657986,1001660133,1001660842,1001669693,1001669694,1001677678,1001679046,1001700927,1001700928,1001702721,1001704681,1001742093,1001742094,1001744392,1001745345,1001745346,1001746262,1001750784,1001752689,1001753784,1001754671,1001754672,1001754673,1001754674,1001756972,1001760086,1001763850,1001765785,1001765786,1001765787,1001772081,1001772082,1001772083,1001772084,1001794530,1001801519,1001801520,1001803594,1001804772,1001805719,1001810141,1001819005,1001824247,1001841089,1001843127,1001849164,1001852646,1001855508,1001856677,1001870205,1001880892,1001882216,1001891781,1001897038,1001897039,1001904763,1001917400,1001929818]
filter_prod=[100001087957081,100003814221599,100003886102970,100005830621411,100007500102178,100008165210077,100071722680513,100073772952220,100088392936336,100967582824162]
b4_sample=b4[b4['TC_id'].isin(filter_tcid)]
pd.io.sql.to_sql(b4_sample,'purchases', con=engine, index=False, if_exists='replace')


